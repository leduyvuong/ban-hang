<% set_page_metadata(title: "Messages") %>

<div class="fixed inset-x-4 bottom-4 z-40 flex justify-end sm:inset-x-auto sm:right-6 sm:bottom-6">
  <div class="flex w-full max-w-5xl flex-col gap-4 sm:flex-row sm:items-end sm:justify-end">
    <div class="sm:hidden">
      <details class="group rounded-3xl bg-white/95 shadow-2xl ring-1 ring-slate-200 backdrop-blur">
        <summary class="flex cursor-pointer items-center justify-between rounded-3xl px-5 py-4 text-sm font-semibold text-slate-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-teal-500">
          Conversations
          <svg class="h-4 w-4 text-slate-400 transition group-open:rotate-180" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.71a.75.75 0 011.08 1.04l-4.25 4.25a.75.75 0 01-1.08 0L5.25 8.27a.75.75 0 01-.02-1.06z" clip-rule="evenodd" />
          </svg>
        </summary>
        <div class="max-h-80 overflow-y-auto border-t border-slate-200/80">
          <%= render partial: "conversations/sidebar", locals: { conversations: @conversations, wrapper_classes: "flex h-full flex-col bg-white/95" } %>
        </div>
      </details>
    </div>
    <aside class="hidden w-full max-w-sm sm:block">
      <%= render partial: "conversations/sidebar", locals: { conversations: @conversations } %>
    </aside>
    <section class="flex w-full max-w-xl flex-col justify-center overflow-hidden rounded-3xl bg-white/95 shadow-2xl ring-1 ring-slate-200 backdrop-blur">
      <div class="px-8 py-12 text-center">
        <h3 class="text-lg font-semibold text-slate-900">Select a conversation</h3>
        <p class="mt-2 text-sm text-slate-500">Choose a chat from the list to open a thread, or start a new one to begin messaging.</p>
      </div>
    </section>
  </div>
</div>
