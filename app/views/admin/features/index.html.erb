<nav class="mb-6 text-sm text-gray-500" aria-label="Breadcrumb">
  <ol class="flex flex-wrap items-center gap-2">
    <li>
      <%= link_to "Admin", admin_root_path, class: "text-indigo-600 hover:text-indigo-500" %>
    </li>
    <li aria-hidden="true">/</li>
    <li>
      <%= link_to "Shops", admin_shops_path, class: "text-indigo-600 hover:text-indigo-500" %>
    </li>
    <li aria-hidden="true">/</li>
    <li class="text-gray-700"><%= @shop.name %></li>
    <li aria-hidden="true">/</li>
    <li class="text-gray-900 font-medium">Features</li>
  </ol>
</nav>

<div class="space-y-6">
  <div class="flex items-center justify-between gap-4">
    <div>
      <h2 class="text-lg font-semibold text-gray-900"><%= @shop.name %> Feature Access</h2>
      <p class="mt-1 text-sm text-gray-600">Unlock capabilities to grant this shop access to new functionality.</p>
    </div>
    <div class="rounded-full bg-gray-100 px-4 py-2 text-sm font-medium text-gray-700">
      <%= pluralize(@unlocked_feature_count, "feature") %> unlocked
    </div>
  </div>

  <div class="overflow-hidden rounded-xl border border-gray-200 shadow-sm">
    <table class="min-w-full divide-y divide-gray-200 bg-white">
      <thead class="bg-gray-50">
        <tr>
          <th scope="col" class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-500">Feature</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-500">Category</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-500">Description</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-500">Status</th>
          <th scope="col" class="px-6 py-3 text-left text-xs font-semibold uppercase tracking-wide text-gray-500"><span class="sr-only">Actions</span></th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-200">
        <% @features.each do |feature| %>
          <% shop_feature = @shop_features[feature.id] %>
          <% unlocked = shop_feature&.unlocked? %>
          <tr class="transition hover:bg-gray-50/50">
            <td class="px-6 py-4 text-sm font-medium text-gray-900">
              <%= feature.name %>
            </td>
            <td class="px-6 py-4 text-sm text-gray-600">
              <span class="inline-flex items-center rounded-full bg-gray-100 px-3 py-1 text-xs font-semibold text-gray-700">
                <%= feature.category.present? ? feature.category.titleize : "Uncategorized" %>
              </span>
            </td>
            <td class="px-6 py-4 text-sm text-gray-600">
              <%= feature.description.presence || "â€”" %>
            </td>
            <td class="px-6 py-4 text-sm">
              <% if unlocked %>
                <span class="inline-flex items-center gap-1 rounded-full bg-emerald-50 px-3 py-1 text-xs font-semibold text-emerald-700">
                  âœ“ Unlocked
                </span>
              <% else %>
                <span class="inline-flex items-center gap-1 rounded-full bg-rose-50 px-3 py-1 text-xs font-semibold text-rose-700">
                  ðŸ”’ Locked
                </span>
              <% end %>
            </td>
            <td class="px-6 py-4 text-right text-sm">
              <% if unlocked %>
                <span class="inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700">Unlocked</span>
              <% else %>
                <%= form_with url: unlock_admin_shop_feature_path(@shop, feature), method: :post, class: "inline-block" do |form| %>
                  <%= form.submit "Unlock", class: "inline-flex items-center rounded-full bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-indigo-500" %>
                <% end %>
              <% end %>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
